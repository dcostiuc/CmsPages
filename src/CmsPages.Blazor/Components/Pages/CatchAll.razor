@page "/{*path}"
@using CmsPages.Pages
@inject NavigationManager NavigationManager
@inject IPageAppService PageAppService

@code {
    [Parameter] public string? path { get; set; }

    private static readonly string[] KnownRoutes = new[]
    {
"account", "tenant-management", "identity", "setting-management", "home", "not-found",
};

    protected override async Task OnInitializedAsync()
    {
        var fullPath = path?.TrimEnd('/') ?? string.Empty;
        var baseSegment = fullPath.Split('/', StringSplitOptions.RemoveEmptyEntries).FirstOrDefault();

        // If it's a known system route, ignore this component
        if (KnownRoutes.Contains(baseSegment, StringComparer.OrdinalIgnoreCase))
        {
            return;
        }

        var page = await PageAppService.GetByRouteNameAsync(fullPath);

        // if it's a page, go to it and have the PageRenderer handle it
        if (page != null)
        {
            NavigationManager.NavigateTo($"/page/{page.RouteName}");
        }
        else
        {
            NavigationManager.NavigateTo("/not-found");
        }
    }
}
